{% load static %}

<article class="art3">
  <h1 class="C_title">history</h1>
  <div class="main area">
    <div class="table area" style="margin-right:40px; display: block;">
      <table class="table-box">
        {% if mycars.exists %}
        <caption>  </caption>
        <thead>
          <tr class="table_title">
            <td><h1>User_ID</h1></td>
            <td><h1>Speed</h1></td>
            <td><h1>Battery</h1></td>
            <td><h1>Color</h1></td>
            <td><h1>Created_at</h1></td>
          </tr>
        </thead>
          <div style="width: 52vw; height: 40;">
              {% for mycar in mycars %}
              <tbody>
                <tr>
                  <td><h1>{{ mycar.user_name }}</h1></td>
                  <td><h1>{{ mycar.mycar_speed }}</h1></td>
                  <td><h1>{{ mycar.mycar_battery }}</h1></td>
                  <td><h1>{{ mycar.mycar_color }}</h1></td>
                  <td><h1>{{ mycar.created_at }}</h1></td>
                  <td>
                    {% if user_name %}
                    <form action="{{ mycar.get_delete_url }}" method="post">
                      {% csrf_token %}
                      <button type="submit">삭제</button>
                    </form>
                    {% endif%}
                  </td>
                </tr>
              </tbody>
              {% endfor %}
          </div>             
      </table>
      {% endif %}
    </div>

      <div class="table_area" style="margin-right:40px; display: none;">
        <table class="table-box">
          {% if mycars.exists %}
          <caption>  </caption>
          <thead>
            <tr class="table_title">
              <th><h1>User_ID</h1></th>
              <th><h1>Speed</h1></th>
              <th><h1>Battery</h1></th>
              <th><h1>Color</h1></th>
              <th><h1>Created_at</h1></th>
            </tr>
          </thead>
                {% for mycar in mycars %}
                <tbody>
                  <tr>
                    <td><h1>{{ mycar.user_name }}</h1></td>
                    <td><h1>{{ mycar.mycar_speed }}</h1></td>
                    <td><h1>{{ mycar.mycar_battery }}</h1></td>
                    <td><h1>{{ mycar.mycar_color }}</h1></td>
                    <td><h1>{{ mycar.created_at }}</h1></td>
                  </tr>
                </tbody>
                {% endfor %}
        </table>
        {% endif %}
      </div>
  </div>


  <div class="setting_box">
    <h3>SETTING</h3>
    <h5>기본설정은 1개만 설정됩니다.</h5>
    <div class="selectBox">
      <select name="modelss" class="select">
        <option disabled selected>모델을 선택해 주세요 </option>
        <option value="r1">R1</option>
        <option value="r1mini">R1 mini</option>
        <option value="allr1">All R1</option>
      </select>
      <span class="icoArrow">&#9989;</span> </div>
    <br/>
    <br/>
    <div class="ckbox area">
      <label class="checkbox area" >수기입력
          <input type="checkbox" id="ck1" onclick="toggleTextBox(this)" name="ckbox1"/>
      </label>
      <br/>
      <label class="multi click" >다중세팅
          <input type="checkbox" id="mtck" onclick="toggleMulti(this)" name="ckbox2"/>
      </label>
    </br></br>
    </div>



  <form class="setting area" action="createmycar/" method="post">
      {% csrf_token %}
      <div id="selbox">
          <select id="selectbox" onchange="changemenu()" name="mycarselector">
              <option value="">기능 선택</option>
              <option value="speed" name="speed">SPEED</option>
              <option value="battery" name="battery">NAME</option>
              <option value="color" name="color">COLOR</option>
          </select>
          <span class="icoArrow">&#9989;</span>
          
        <div class="textinput area" style="display: block;" id="mainbox">
          <input type="text" id="sett" name="number" placeholder="설정값 입력"/> 
        </div>
      </div>
      <div class="color area" id="colorbox" style="display: none;">
        <!-- <input type="color" name="color"> -->
      </div> 
    <br/>
    <br/>
    <div class="submin area" id="bt1" style="display: block;">
      &nsup; &nsup;
        <button class="btn-c" type="submit">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          전송 1
        </button>
    </div>
  </form>


  <form action="createmycarset/" method="post">
    {% csrf_token %}
      <div class="multiset" id="mtset" style="display: none;" >
          <div name="battery">
          <input type="range" min="0" max="100" id="bat" step="1" value="0" name="battery">
          <br/>
          <label for="bat">BATTERY : 
          <span id="batval" class="batval"></span> % </label>
        </div>
          <div name="speed">
          <input type="range" min="0" max="100" id="spd" step="1" value="0" name="speed" >
          <br/>
          <label for="spd">SPEED :
          <output id="spdval" class="spdval"></output> km/h </label>
          <br/>
          </div>
          <div name="color">
          <input type="color" id="col"  name="color"><br/>
          <label>COLOR : <output for="col" class="col"></output></label>
          <br/>
          </div>
      </div>
    <div class="submin area" id="bt2" style="display: none;">
      &nsup; &nsup;
        <button class="btn-c" type="submit">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          전송 2
        </button>
    </div>
  </form>

  <form action="createmycar/" method="post">
    {% csrf_token %}
      <div class="two text" id="twotext" style="display: none;">
          <input type="text" value="" placeholder="세팅모드를 적어주세요" name="carset">
          <br/>
          <input type="text" value="" placeholder="숫자로 입력해주세요" name="carnum">
          <br/>
      </div>  
    
      <div class="submin area" id="bt3" style="display: none;" >
        &nsup; &nsup;
          <button class="btn-c" type="submit" >
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            전송 3
          </button> 
      </div>
  </form>
    
</div>
</article>


<script>

    $(() => {
      $(".batval").text($("input[name='battery']").val())
      $(".encoder_value").text($("input[name='encoder']").val())
  })

</script>

<script>

document.querySelector('#bat').addEventListener('input',e=>{
document.querySelector('#batval').innerHTML = e.target.value;
});

document.querySelector('#spd').addEventListener('input',e=>{
document.querySelector('#spdval').innerHTML = e.target.value;
});
</script>

<script>
function changemenu(value){
var selectvalSet = document.getElementById('selectbox');
const colorbox = document.getElementById('colorbox');
const mainbox = document.getElementById('mainbox');
const sett = document.getElementById('sett');
const bt1 = document.getElementById('bt1');
const bt2 = document.getElementById('bt2');
const bt3 = document.getElementById('bt3');

var setval = selectvalSet.options[selectvalSet.selectedIndex].value;

const setcolor = 'color';

if(setval == setcolor){
    colorbox.style.display = 'block';
    mainbox.style.display = 'none';
    sett.value = null ;
}else{
    colorbox.style.display = 'none';
    mainbox.style.display = 'block';
}
}
</script>

<script>
function toggleTextBox(checkbox){ //수기입력 함수
const selbox = document.getElementById('selbox'); //셀렉트 박스
const setbox = document.getElementById('twotext');  //수기div
const mtck = document.getElementById('mtck');  //다중선택 체크박스
var ck1 = document.getElementById('ck1');  //수기입력 체크박스
const mtset = document.getElementById('mtset');  //다중선택 div
const mainbox = document.getElementById('mainbox');
const bt1 = document.getElementById('bt1');
const bt2 = document.getElementById('bt2');
const bt3 = document.getElementById('bt3');



if(ck1.checked==true){
  selbox.style.display = 'none';
  setbox.style.display = 'block';
  mtset.style.display = 'none';
  mtck.checked = false;
  mainbox.value = null;
  bt1.style.display = 'none';
  bt2.style.display = 'none';
  bt3.style.display = 'block';
}else{
  selbox.style.display = 'block';
  setbox.style.display = 'none';
  mtset.style.display = 'none';
  bt1.style.display = 'block';
  bt2.style.display = 'none';
  bt3.style.display = 'none';
}

}
</script>

<script>
function toggleMulti(checkbox){
const selbox = document.getElementById('selbox'); //셀렉박스
const mtset = document.getElementById('mtset'); //멀티설정 div
const setbox = document.getElementById('twotext'); //수기입력 div
const ck1 = document.getElementById('ck1'); //수기입력 checkbox
const mtck = document.getElementById('mtck'); //멀티설정 checkbox
const bt1 = document.getElementById('bt1');
const bt2 = document.getElementById('bt2');
const bt3 = document.getElementById('bt3');


if(mtck.checked==true){
  selbox.style.display = 'none';
  setbox.style.display = 'none';
  mtset.style.display = 'block';
  ck1.checked = false;
  bt1.style.display = 'none';
  bt2.style.display = 'block';
  bt3.style.display = 'none';
}else{
  selbox.style.display = 'block';
  setbox.style.display = 'none';
  mtset.style.display = 'none';
  bt1.style.display = 'block';
  bt2.style.display = 'none';
  bt3.style.display = 'none';
}

}
</script>
